## ADDED Requirements

### Requirement: スタッフを日付・時間帯に手動でアサインできる
システムは、ユーザーがスタッフを特定の日付・時間帯に手動でアサイン（割り当て）できなければならない（SHALL）。アサインはLocalStorageに永続化される。

#### Scenario: スタッフをシフトにアサインできる
- **WHEN** ユーザーがシフト表のセル（スタッフ×日付）から時間帯を選択してアサインする
- **THEN** アサインがLocalStorageに保存され、シフト表に反映される

#### Scenario: アサインを解除できる
- **WHEN** ユーザーが既存のアサインを解除する操作を行う
- **THEN** そのアサインがLocalStorageから削除され、シフト表からも消える

---

### Requirement: 週上限出勤回数を超えるアサインは警告を表示する
システムは、あるスタッフの週当たりのアサイン数がそのスタッフの週上限出勤回数を超えた場合、警告を表示しなければならない（SHALL）。ただし保存自体は行える。

#### Scenario: 週上限を超えた場合に警告が表示される
- **WHEN** スタッフの週アサイン数が週上限出勤回数を超えるアサインを行う
- **THEN** 「週上限を超えています」などの警告が表示されるが、アサインは保存される

---

### Requirement: 出勤不可時間帯へのアサインは警告を表示する
システムは、スタッフの出勤可能時間帯に含まれない時間帯にアサインしようとした場合、警告を表示しなければならない（SHALL）。ただし保存自体は行える。

#### Scenario: 出勤不可時間帯への割り当て時に警告が表示される
- **WHEN** スタッフが出勤不可と設定している時間帯にアサインを行う
- **THEN** 「この時間帯は出勤不可です」などの警告が表示されるが、アサインは保存される

---

### Requirement: 希望休日へのアサインをハイライト表示する
システムは、希望休が登録されている日にアサインされているスタッフのセルを視覚的に区別できなければならない（SHALL）。

#### Scenario: 希望休日のアサインが強調表示される
- **WHEN** 希望休が登録されている日にそのスタッフがアサインされている
- **THEN** シフト表のそのセルが希望休アサインを示す色（例：赤）でハイライト表示される

---

### Requirement: 駐車場をアサイン時に自動割り当てする
システムは、駐車場利用フラグがONのスタッフがアサインされた際、以下の優先順位で駐車場枠を割り当てなければならない（SHALL）。

1. 同一スタッフが同一日にすでに駐車場枠が割り当てられているアサインが存在する場合、その既存の枠を再利用する
2. 既存の割り当てがない場合、その日の空き枠をA優先・先着順で新規割り当てする
3. 空き枠がない場合は割り当てなしとする

#### Scenario: 駐車場枠が空いている場合に自動割り当てされる
- **WHEN** 駐車場利用フラグがONのスタッフをアサインする（その日に初めてのアサイン）
- **THEN** その日に空いている駐車場枠（A優先、次にB）が自動的に割り当てられる

#### Scenario: 駐車場枠が満杯の場合は割り当てなしになる
- **WHEN** 駐車場利用フラグがONのスタッフをアサインするが、その日の全駐車場枠がすでに埋まっている
- **THEN** 駐車場番号なしでアサインが保存される

#### Scenario: 同一スタッフが同一日に複数時間帯でアサインされる場合は既存枠を再利用する
- **WHEN** 駐車場利用フラグがONのスタッフが同一日の別の時間帯にすでにアサインされており（駐車場枠が割り当て済み）、さらに別の時間帯にアサインする
- **THEN** 新たに駐車場枠を消費せず、既存のアサインと同じ駐車場枠が割り当てられる

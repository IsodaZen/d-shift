## タスクリスト

### Phase 1: テスト追加（Red）

- [x] `src/utils/autoShiftGenerator.test.ts` に制約1（全時間帯出勤の原則）のテストを追加する（Red）
  - 「午前・午後対応可のスタッフを出勤させる場合、午前と午後の両方にアサインされる」
  - 「午前・午後対応可のスタッフが、午前のみ必要な日に出勤させられる場合でも午後にもアサインされる（例外超過として許容）」
  - 「午前のみ対応スタッフは午前のみにアサインされる（変化なし）」

- [x] `src/utils/autoShiftGenerator.test.ts` に制約2（必要人数超過禁止）のテストを追加する（Red）
  - 「各時間帯のアサイン数が必要人数を超えない（通常ケース）」
  - 「全時間帯が既に必要人数を満たしている場合、それ以上スタッフをアサインしない」
  - 「制約1による例外超過は許容されるが、最小人数になる（超過を最小化する）」

---

### Phase 2: アルゴリズム変更（Green）

- [x] `src/utils/autoShiftGenerator.ts` のアルゴリズムを「日」単位処理に変更する（Green）
  - 現在の `for (date) → for (slot)` 二重ループを `for (date)` の一重ループに変更する
  - 各日に対して候補スタッフ（希望休なし・週上限未達）を抽出する
  - 候補スタッフを週アサイン数の少ない順にソートする
  - 各候補スタッフに対して「この日に出勤させるか」を判定する:
    - そのスタッフの利用可能時間帯のうち、まだ必要数が埋まっていない時間帯が1つでもあればアサインする
    - 全時間帯が既に必要数に達している場合はスキップする
  - アサイン対象と決定したスタッフは、必要人数が0より大きい全利用可能時間帯にアサインする（制約1）
  - アサイン後に各時間帯のカウンターを更新する（制約2の管理）

---

### Phase 3: 動作確認

- [x] `bun run test` を実行し、全テストがパスすることを確認する
- [x] `bun run build` を実行し、エラーなくビルドが完了することを確認する

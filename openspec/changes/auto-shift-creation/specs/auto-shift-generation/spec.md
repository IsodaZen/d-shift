## ADDED Requirements

### Requirement: シフト作成期間全体のシフト叩き台をワンクリックで自動生成できる
システムは、登録済みのシフト作成期間を対象に、全スタッフ・全日程のシフト割り当て叩き台を一括生成できなければならない（SHALL）。生成結果はLocalStorageに保存され、通常の手動アサインと同じデータ構造で扱われる。

#### Scenario: 自動生成を実行するとシフトが生成される
- **WHEN** ユーザーが「自動生成」ボタンを押し、確認ダイアログで実行を承認する
- **THEN** シフト作成期間内のすべての日付・時間帯に対して制約を満たすアサインが生成され、LocalStorageに保存される

---

### Requirement: 既存のアサインがある場合は上書き確認ダイアログを表示する
システムは、シフト作成期間内に既存のアサインが1件以上存在する場合、自動生成を実行する前に上書き確認ダイアログを表示しなければならない（SHALL）。ユーザーがキャンセルした場合は既存のアサインを保持する。

#### Scenario: 既存アサインがある場合は確認ダイアログが表示される
- **WHEN** シフト作成期間内に既存のアサインが存在する状態で「自動生成」ボタンを押す
- **THEN** 上書きの確認ダイアログが表示される

#### Scenario: 確認ダイアログでキャンセルすると既存アサインが保持される
- **WHEN** 上書き確認ダイアログで「キャンセル」を選択する
- **THEN** 自動生成は実行されず、既存のアサインはそのまま保持される

#### Scenario: 既存アサインがない場合は確認なく生成される
- **WHEN** シフト作成期間内にアサインが1件も存在しない状態で「自動生成」ボタンを押す
- **THEN** 確認ダイアログを表示せず、直ちに自動生成が実行される

---

### Requirement: 希望休の日にはアサインしない（強制制約）
システムは、自動生成時に希望休が登録されているスタッフ・日付の組み合わせへの割り当てを行ってはならない（SHALL NOT）。

#### Scenario: 希望休登録日にはアサインが生成されない
- **WHEN** スタッフAの特定の日に希望休が登録されている状態で自動生成を実行する
- **THEN** その日のスタッフAへのアサインは生成されない

---

### Requirement: スタッフの出勤可能時間帯のみに割り当てる（強制制約）
システムは、自動生成時にスタッフの出勤可能時間帯として登録されていない時間帯へのアサインを行ってはならない（SHALL NOT）。

#### Scenario: 出勤不可の時間帯にはアサインが生成されない
- **WHEN** スタッフBの出勤可能時間帯が「午前・午後」のみで登録されている状態で自動生成を実行する
- **THEN** スタッフBへの「夕方」のアサインは生成されない

---

### Requirement: 週上限出勤回数を超えない（強制制約）
システムは、自動生成時に各スタッフの週上限出勤回数（月曜〜日曜の7日間単位）を超えるアサインを生成してはならない（SHALL NOT）。同一日に複数の時間帯にアサインされる場合も1出勤としてカウントする。

#### Scenario: 週上限に達したスタッフにはそれ以上アサインが生成されない
- **WHEN** スタッフCの週上限が3回で、ある週にすでに3日分のアサインが生成された場合
- **THEN** その週のスタッフCへの追加アサインは生成されない

---

### Requirement: 各日・各時間帯の必要人数を可能な限り満たす（ベストエフォート）
システムは、シフト枠設定で定義された各日・各時間帯の必要人数を達成するよう、制約の範囲内で最大限スタッフを割り当てなければならない（SHALL）。制約により必要人数を満たせない場合は達成できる範囲でアサインを生成し、不足の場合もエラーにはならない。

#### Scenario: 制約を満たしつつ必要人数分のアサインが生成される
- **WHEN** ある日の午前の必要人数が3人で、制約を満たす割り当て可能なスタッフが3人以上いる
- **THEN** その日の午前に3人がアサインされる

#### Scenario: スタッフ不足の場合は達成可能な人数でアサインが生成される
- **WHEN** ある日の午前の必要人数が3人だが、制約を満たす割り当て可能なスタッフが1人しかいない
- **THEN** 1人がアサインされ、エラーは発生しない

---

### Requirement: 自動生成後に必要人数を満たせなかった日時帯を通知する
システムは、自動生成完了後に必要人数を1人以上満たせなかった日付・時間帯の一覧をユーザーに提示しなければならない（SHALL）。必要人数をすべて満たせた場合は不足なしとして通知する。

#### Scenario: 不足がある場合は不足一覧が表示される
- **WHEN** 自動生成が完了し、必要人数を満たせなかった日付・時間帯が1件以上ある
- **THEN** 生成完了後に不足一覧（日付・時間帯・不足人数）が表示される

#### Scenario: すべての必要人数を満たせた場合は不足なしと通知される
- **WHEN** 自動生成が完了し、すべての日付・時間帯で必要人数が達成されている
- **THEN** 「必要人数をすべて満たしました」旨のメッセージが表示される
